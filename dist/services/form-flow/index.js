"use strict";var V=Object.defineProperty,G=Object.defineProperties,J=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var M=(a,e,F)=>e in a?V(a,e,{enumerable:!0,configurable:!0,writable:!0,value:F}):a[e]=F,w=(a,e)=>{for(var F in e||(e={}))B.call(e,F)&&M(a,F,e[F]);if(I)for(var F of I(e))X.call(e,F)&&M(a,F,e[F]);return a},N=(a,e)=>G(a,K(e));var Y=(a,e)=>{for(var F in e)V(a,F,{get:e[F],enumerable:!0})},Z=(a,e,F,d)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of Q(e))!B.call(a,t)&&t!==F&&V(a,t,{get:()=>e[t],enumerable:!(d=J(e,t))||d.enumerable});return a};var $=a=>Z(V({},"__esModule",{value:!0}),a);var b=(a,e,F)=>new Promise((d,t)=>{var m=c=>{try{u(F.next(c))}catch(P){t(P)}},p=c=>{try{u(F.throw(c))}catch(P){t(P)}},u=c=>c.done?d(c.value):Promise.resolve(c.value).then(m,p);u((F=F.apply(a,e)).next())});var ie={};Y(ie,{allRequiredFieldsExists:()=>te,createFormFlow:()=>ee});module.exports=$(ie);var O=require("react"),A=({context:a})=>()=>(0,O.useContext)(a);var R=require("react");function L(){return(0,R.createContext)({getStoreFields:()=>null,CurrentStepView:()=><></>,updateStoreFields:()=>b(this,null,function*(){}),moveToPreviousValidStep:()=>{},moveToNextValidStep:()=>{},progressPercentage:0,meta:{previousStepIdentifier:null,currentStepIdentifier:null,nextStepIdentifier:null,isFirstStep:!0,isLastStep:!1}})}var g=require("react");var U=require("react"),H=({flowStore:a,currentStep:e})=>(0,U.useMemo)(()=>{var P,h,S,C,v;let F=a.getHead(),d=a.getTail(),t=(e==null?void 0:e.index)===(F==null?void 0:F.index),m=(e==null?void 0:e.index)===(d==null?void 0:d.index),p=(h=(P=e==null?void 0:e.previousStep)==null?void 0:P.identifier)!=null?h:null,u=(S=e==null?void 0:e.identifier)!=null?S:null,c=(v=(C=e==null?void 0:e.nextStep)==null?void 0:C.identifier)!=null?v:null;return{isFirstStep:t,isLastStep:m,previousStepIdentifier:p,currentStepIdentifier:u,nextStepIdentifier:c}},[e]);function W({flowStore:a,getFields:e,updateFields:F,isFormFlowResumable:d}){let[t,m]=(0,g.useState)(null),p=(0,g.useMemo)(()=>{let S=t==null?void 0:t.Component;return S?()=><S storeFields={e()}updateStoreFields={F}moveToNextStep={c}moveToPreviousStep={P}moveToStepByIdentifier={h}/>:()=><></>},[t]),u=H({flowStore:a,currentStep:t});(0,g.useEffect)(()=>{let S=d?a.getLastIncompleteStep(e()):a.getHead();m(S)},[]);let c=()=>{let S=a.getNextValidStep(t,e());m(S)},P=()=>{let S=a.getPreviousValidStep(t,e());m(S)},h=S=>{let C=a.getStepByIdentifier(S);m(C)};return{currentStep:t,meta:u,CurrentStepView:p,moveToNextValidStep:c,moveToPreviousValidStep:P,moveToStepByIdentifier:h}}var k=require("react");var z=({initialStoreFields:a,onStoreUpdate:e})=>{let F=(0,k.useRef)(a),d=()=>F.current;return{getFields:d,updateFields:m=>b(void 0,null,function*(){let p=d(),u=w(w({},p),m);F.current=u,e&&(yield e(u))})}};var E=require("react"),_=({flowStore:a,getFields:e,currentStep:F})=>({progressPercentage:(0,E.useMemo)(()=>{let{currentStepIndex:m,numberOfValidSteps:p}=a.getTotalOfValidSteps(F,e());return m/p*100},[F])});var T=class{constructor({isAValidationView:e,previousStep:F,nextStep:d,doesMeetConditionFields:t,Component:m,index:p,identifier:u,willBePartOfTheFlow:c}){this.index=p,this.identifier=u,this.Component=m,this.isAValidationView=!!e,this.previousStep=F,this.nextStep=d,this.doesMeetConditionFields=t||(()=>!0),this.willBePartOfTheFlow=c||(()=>!0)}};var y=class{constructor(e){this.getHead=()=>this.head;this.getTail=()=>this.tail;this.getNextValidStep=(e,F)=>{var p;let d=(e==null?void 0:e.index)===((p=this.tail)==null?void 0:p.index),t=(e==null?void 0:e.nextStep)||null;if(!e||d||!t)return null;let m=((e==null?void 0:e.index)||0)+1;for(let u=m;u<=this.length;u++){if(t==null?void 0:t.doesMeetConditionFields(F))return t;t=(t==null?void 0:t.nextStep)||null}return null};this.getPreviousValidStep=(e,F)=>{var m;let d=(e==null?void 0:e.index)===((m=this.head)==null?void 0:m.index),t=e==null?void 0:e.previousStep;if(!e||d||!t)return null;for(let p=this.length-1;p>=0;p--){let u=!!(t!=null&&t.doesMeetConditionFields(F)),c=!(t!=null&&t.isAValidationView);if(u&&c)return t;t=(t==null?void 0:t.previousStep)||null}return null};this.getTotalOfValidSteps=(e,F)=>{let d=0,t=0,m=this.getHead();for(let p=0;p<=this.length;p++){let u=!!(m!=null&&m.willBePartOfTheFlow(F)),c=!(m!=null&&m.isAValidationView);(m==null?void 0:m.index)===(e==null?void 0:e.index)&&(d=t),u&&c&&t++,m=(m==null?void 0:m.nextStep)||null}return{numberOfValidSteps:t,currentStepIndex:d}};this.getLastIncompleteStep=e=>{let F=this.head,d=this.head;for(let t=0;t<this.length;t++){let m=!(d!=null&&d.isAValidationView),p=!!(d!=null&&d.doesMeetConditionFields(e)),u=!!(d!=null&&d.willBePartOfTheFlow(e));m&&p&&u&&(F=d),d=(d==null?void 0:d.nextStep)||null}return F};this.getStepByIdentifier=e=>{let F=this.head;for(let d=0;d<this.length;d++){if((F==null?void 0:F.identifier)===e)return F;F=(F==null?void 0:F.nextStep)||null}return null};this.initializeSteps=e=>{for(let[F,d]of e.entries()){let t=new T(N(w({},d),{previousStep:this.tail,nextStep:null,index:F}));this.head===null&&(this.head=t),this.tail!==null&&(this.tail.nextStep=t),this.tail=t,this.length+=1}return this};this.head=null,this.tail=null,this.length=0,this.initializeSteps(e)}};function q({context:a,steps:e}){let F=a.Provider;return({initialStoreFields:d,onStoreUpdate:t,isResumable:m=!1,children:p})=>{let u=new y(e),{getFields:c,updateFields:P}=z({initialStoreFields:d,onStoreUpdate:t}),{currentStep:h,meta:S,CurrentStepView:C,moveToNextValidStep:v,moveToPreviousValidStep:j}=W({flowStore:u,getFields:c,updateFields:P,isFormFlowResumable:m}),{progressPercentage:D}=_({flowStore:u,getFields:c,currentStep:h});return<F value={{getStoreFields:c,updateStoreFields:P,CurrentStepView:C,moveToPreviousValidStep:j,moveToNextValidStep:v,progressPercentage:D,meta:S}}>{p}</F>}}function ee({steps:a}){let e=L(),F=A({context:e}),d=q({context:e,steps:a});return[F,d]}var te=a=>a.every(Boolean);0&&(module.exports={allRequiredFieldsExists,createFormFlow});
